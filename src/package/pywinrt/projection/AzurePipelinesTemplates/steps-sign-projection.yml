
parameters:
  architecture: 'amd64'
  artifactName: 'projection'
  publishArtifactName: 'signed-projection'

steps:
- task: ExtractFiles@1
  inputs:
    archiveFilePatterns: '$(Build.ArtifactStagingDirectory)/${{ parameters.artifactName }}/${{ parameters.architecture }}.zip'
    destinationFolder: _projection/${{ parameters.architecture }}
    cleanDestinationFolder: true 

 - task: PkgESCodeSign@10
    displayName: CodeSign
    inputs:
      signConfigXml: '$(Build.SourcesDirectory)/src/package/pywinrt/projection/SignConfig.xml'
      inPathRoot: '_projection/${{ parameters.architecture }}/pywinrt/winrt'
      outPathRoot: '_projection/${{ parameters.architecture }}/pywinrt/winrt'

- task: ArchiveFiles@2
  inputs:
    rootFolderOrFile: _projection/${{ parameters.architecture }}/pywinrt
    archiveFile: '$(Build.ArtifactStagingDirectory)/${{ parameters.publishArtifactName }}/${{ parameters.architecture }}.zip'


